<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="QuickKit.Pages.JavaVersionPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:QuickKit.Pages"
    xmlns:models="using:QuickKit.Models"
    xmlns:converters="using:QuickKit.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>
        <DataTemplate x:Key="JavaItemTemplate" x:DataType="models:JavaDistribution">
            <Border
                Padding="16,12"
                BorderThickness="0,0,0,1"
                BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                Background="{ThemeResource LayerFillColorDefaultBrush}"
                CornerRadius="8"
                Margin="0,0,0,4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" MinWidth="140"/>
                    <ColumnDefinition Width="Auto" MinWidth="80"/>
                    <ColumnDefinition Width="Auto" MinWidth="100"/>
                    <ColumnDefinition Width="2*" MinWidth="200"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Spacing="8">
                    <TextBlock
                        Text="{x:Bind DisplayName}"
                        FontWeight="SemiBold"
                        FontSize="14"/>
                    <Border
                        x:Name="ActiveBadge"
                        Visibility="{x:Bind IsActive, Mode=OneWay, Converter={StaticResource BoolToVisibility}}"
                        Background="{ThemeResource AccentFillColorDefaultBrush}"
                        CornerRadius="4"
                        Padding="8,4"
                        VerticalAlignment="Center">
                        <TextBlock Text="当前生效" Foreground="White" FontSize="12" FontWeight="SemiBold"/>
                    </Border>
                </StackPanel>
                <TextBlock
                    Grid.Column="1"
                    Text="{x:Bind Version}"
                    VerticalAlignment="Center"
                    FontFamily="Consolas"
                    FontSize="13"
                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                <TextBlock
                    Grid.Column="2"
                    Text="{x:Bind Vendor}"
                    VerticalAlignment="Center"
                    FontSize="13"
                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                    TextTrimming="CharacterEllipsis"/>
                <TextBlock
                    Grid.Column="3"
                    Text="{x:Bind HomePath}"
                    VerticalAlignment="Center"
                    FontFamily="Consolas"
                    FontSize="12"
                    Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                    TextTrimming="CharacterEllipsis"
                    ToolTipService.ToolTip="{x:Bind HomePath}"/>
            </Grid>
            </Border>
        </DataTemplate>
    </Page.Resources>

    <Grid Padding="24,16" RowSpacing="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 标题 -->
        <StackPanel Grid.Row="0" Spacing="4">
            <TextBlock
                Text="Java 版本控制"
                FontSize="28"
                FontWeight="Bold"/>
            <TextBlock
                Text="查看与切换系统中已安装的 Java 发行版及当前生效的环境变量"
                FontSize="14"
                Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
        </StackPanel>

        <!-- 当前生效的版本 卡片 -->
        <Border
            Grid.Row="1"
            Background="{ThemeResource LayerFillColorDefaultBrush}"
            BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
            BorderThickness="1"
            CornerRadius="12"
            Padding="20">
            <StackPanel Spacing="12">
                <TextBlock
                    Text="当前生效的版本"
                    FontSize="16"
                    FontWeight="SemiBold"/>
                <StackPanel x:Name="ActiveVersionPanel" Spacing="8">
                    <TextBlock x:Name="ActiveVersionText" FontSize="15"/>
                    <TextBlock x:Name="ActivePathText" FontFamily="Consolas" FontSize="13" Foreground="{ThemeResource TextFillColorSecondaryBrush}" TextWrapping="Wrap"/>
                </StackPanel>
                <TextBlock
                    x:Name="NoActiveVersionText"
                    Visibility="Collapsed"
                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                    Text="未检测到 JAVA_HOME，或路径无效。请设置系统/用户环境变量 JAVA_HOME 或在下方选择发行版进行切换。"/>
            </StackPanel>
        </Border>

        <!-- 已安装的发行版列表 -->
        <StackPanel Grid.Row="2" Spacing="12">
            <TextBlock
                Text="已安装的 Java 发行版"
                FontSize="18"
                FontWeight="SemiBold"/>
            <Border
                Background="{ThemeResource LayerFillColorDefaultBrush}"
                BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                BorderThickness="1"
                CornerRadius="12"
                Padding="12">
                <Grid>
                    <!-- 表头 -->
                    <Grid
                        Padding="16,10,16,8"
                        BorderThickness="0,0,0,1"
                        BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                        Margin="0,0,0,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" MinWidth="140"/>
                            <ColumnDefinition Width="Auto" MinWidth="80"/>
                            <ColumnDefinition Width="Auto" MinWidth="100"/>
                            <ColumnDefinition Width="2*" MinWidth="200"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="发行版" FontWeight="SemiBold" FontSize="13" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        <TextBlock Grid.Column="1" Text="版本" FontWeight="SemiBold" FontSize="13" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        <TextBlock Grid.Column="2" Text="供应商" FontWeight="SemiBold" FontSize="13" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        <TextBlock Grid.Column="3" Text="安装路径" FontWeight="SemiBold" FontSize="13" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    </Grid>
                    <ListView
                        x:Name="JavaList"
                        ItemTemplate="{StaticResource JavaItemTemplate}"
                        SelectionMode="None"
                        IsItemClickEnabled="False"
                        HorizontalAlignment="Stretch"
                        Margin="0,44,0,0"/>
                </Grid>
            </Border>
        </StackPanel>
    </Grid>
</Page>
